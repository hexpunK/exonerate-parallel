/* Code automatically generated by C4 DP library
 * Do not attempt to edit this code: it is spagetti.
 *
 * Model: affine:local:dna2dna
 */

 /* ---< START >--- */

#include "ungapped.h"
#include "submat.h"
#include "affine.h"

/* Seeded Viterbi DP implementation. */

#include "scheduler.h"

void Scheduler_Cell_process_affine_58_local_58_dna2dna_58_forward_58_traceback_58_seeded(Scheduler_Cell *cell,
        Scheduler_Row *row,
        Scheduler_Pair *spair){
register gint seed_id = 0;
register gint src_query_pos,
              src_target_pos,
              dst_query_pos,
              dst_target_pos;
register C4_Score src_score, dst_score,
         transition_score, max_score;
register C4_Transition *transition;
register Scheduler_Row *dst_row;
register Scheduler_Cell *dst_cell;
src_query_pos = cell->query_pos;
src_target_pos = row->target_pos;
transition = spair->scheduler->model->transition_list->pdata[8];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_8;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_8;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_8;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[1][0])
goto end_of_transition_8;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 1,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_8:
transition = spair->scheduler->model->transition_list->pdata[7];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_7;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[3][0];
max_score = cell->score[3][1];
seed_id   = cell->score[3][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_7;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_7;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_7;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 3,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_7:
transition = spair->scheduler->model->transition_list->pdata[6];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_6;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[4][0];
max_score = cell->score[4][1];
seed_id   = cell->score[4][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_6;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_6;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_6;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 4,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_6:
transition = spair->scheduler->model->transition_list->pdata[5];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_5;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[0][0];
max_score = cell->score[0][1];
seed_id   = cell->score[0][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_5;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_5;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_5;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 0,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_5:
transition = spair->scheduler->model->transition_list->pdata[4];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_4;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_4;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_4;
if(spair->subopt_index){
if(SubOpt_Index_is_blocked(
spair->subopt_index,
src_query_pos-spair->region->query_start))
goto end_of_transition_4;
}
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_4;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_4:
transition = spair->scheduler->model->transition_list->pdata[3];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_3;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_3;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_3;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[3][0])
goto end_of_transition_3;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 3,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_3:
transition = spair->scheduler->model->transition_list->pdata[2];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_2;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_2;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_2;
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[4][0])
goto end_of_transition_2;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 4,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_2:
transition = spair->scheduler->model->transition_list->pdata[1];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_1;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[3][0];
max_score = cell->score[3][1];
seed_id   = cell->score[3][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_1;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_1;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[3][0])
goto end_of_transition_1;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 3,
    dst_cell, 3,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_1:
transition = spair->scheduler->model->transition_list->pdata[0];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_0;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[4][0];
max_score = cell->score[4][1];
seed_id   = cell->score[4][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_0;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_0;
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[4][0])
goto end_of_transition_0;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 4,
    dst_cell, 4,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_0:
return;
}

/* ---< END >--- */

