/* Code automatically generated by C4 DP library
 * Do not attempt to edit this code: it is spagetti.
 *
 * Model: NER:affine:local:protein2protein
 */

 /* ---< START >--- */

#include "ungapped.h"
#include "submat.h"
#include "affine.h"
#include "ner.h"

/* Seeded Viterbi DP implementation. */

#include "scheduler.h"

void Scheduler_Cell_process_NER_58_affine_58_local_58_protein2protein_58_forward_58_traceback_58_boundary(Scheduler_Cell *cell,
        Scheduler_Row *row,
        Scheduler_Pair *spair){
register gint seed_id = 0;
register gint src_query_pos,
              src_target_pos,
              dst_query_pos,
              dst_target_pos;
register C4_Score src_score, dst_score,
         transition_score, max_score;
register C4_Transition *transition;
Scheduler_SpanSeed span_seed;
register Scheduler_SpanData *span_data;
register Scheduler_Row *dst_row;
register Scheduler_Cell *dst_cell;
src_query_pos = cell->query_pos;
src_target_pos = row->target_pos;
transition = spair->scheduler->model->transition_list->pdata[12];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_12;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_12;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_12;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[1][0])
goto end_of_transition_12;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 1,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_12:
transition = spair->scheduler->model->transition_list->pdata[11];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_11;
if(cell->permit_span_thaw){
span_data =
    spair->span_history->span_data[0];
Scheduler_SpanData_get_curr(
  span_data, spair->span_seed_cache,
  cell->query_pos, row->target_pos,
  spair->straceback);
if(span_data->curr_span_seed
&& (cell->score[5][0]
   < span_data->curr_span_seed->score)){
cell->score[5][0] = span_data->curr_span_seed->score;
cell->score[5][1] = span_data->curr_span_seed->max;
cell->score[5][2] = span_data->curr_span_seed->seed_id;
cell->traceback[5] = Scheduler_Cell_add_span(
    span_data->curr_span_seed->cell,
    spair->straceback,
    spair->scheduler->span_map[5],
    src_query_pos
    -span_data->curr_span_seed->query_entry,
    src_target_pos
    -span_data->curr_span_seed->target_entry);
}
}
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[5][0];
max_score = cell->score[5][1];
seed_id   = cell->score[5][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_11;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_11;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_11;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 5,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_11:
transition = spair->scheduler->model->transition_list->pdata[10];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_10;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[0][0];
max_score = cell->score[0][1];
seed_id   = cell->score[0][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_10;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_10;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_10;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 0,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_10:
transition = spair->scheduler->model->transition_list->pdata[9];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_9;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[4][0];
max_score = cell->score[4][1];
seed_id   = cell->score[4][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_9;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_9;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_9;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 4,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_9:
transition = spair->scheduler->model->transition_list->pdata[8];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_8;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[3][0];
max_score = cell->score[3][1];
seed_id   = cell->score[3][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_8;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_8;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_8;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 3,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_8:
transition = spair->scheduler->model->transition_list->pdata[7];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_7;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[4][0];
max_score = cell->score[4][1];
seed_id   = cell->score[4][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_7;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_7;
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[4][0])
goto end_of_transition_7;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 4,
    dst_cell, 4,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_7:
transition = spair->scheduler->model->transition_list->pdata[6];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_6;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[3][0];
max_score = cell->score[3][1];
seed_id   = cell->score[3][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_6;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_6;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[3][0])
goto end_of_transition_6;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 3,
    dst_cell, 3,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_6:
transition = spair->scheduler->model->transition_list->pdata[5];
dst_query_pos = src_query_pos + 0;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_5;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_5;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_5;
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 0);
if(dst_cell){
if(dst_score <= dst_cell->score[4][0])
goto end_of_transition_5;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 0, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 4,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_5:
transition = spair->scheduler->model->transition_list->pdata[4];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 0;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_4;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_4;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_4;
dst_row = Lookahead_get(spair->row_index, 0);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 0, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[3][0])
goto end_of_transition_4;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 3,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_4:
transition = spair->scheduler->model->transition_list->pdata[3];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_3;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_3;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_3;
if(spair->subopt_index){
if(SubOpt_Index_is_blocked(
spair->subopt_index,
src_query_pos-spair->region->query_start))
goto end_of_transition_3;
}
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[2][0])
goto end_of_transition_3;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 2,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_3:
transition = spair->scheduler->model->transition_list->pdata[2];
dst_query_pos = src_query_pos + 1;
dst_target_pos = src_target_pos + 1;
if((dst_query_pos > Region_query_end(spair->region))
|| (dst_target_pos > Region_target_end(spair->region)))
goto end_of_transition_2;
transition_score = C4_Calc_score(transition->calc,
   src_query_pos, src_target_pos,
   spair->user_data);
src_score = cell->score[2][0];
max_score = cell->score[2][1];
seed_id   = cell->score[2][2];
dst_score = src_score + transition_score;
if(dst_score < 0)
goto end_of_transition_2;
if((max_score - dst_score)    > spair->scheduler->dropoff)
goto end_of_transition_2;
dst_row = Lookahead_get(spair->row_index, 1);
if(!dst_row){
dst_row = Scheduler_Row_create(dst_target_pos, spair);
Lookahead_set(spair->row_index, 1, dst_row);
Lookahead_move(dst_row->cell_index, cell->query_pos);
}
dst_cell = Lookahead_get(dst_row->cell_index, 1);
if(dst_cell){
if(dst_score <= dst_cell->score[5][0])
goto end_of_transition_2;
} else {
dst_cell = Scheduler_Cell_create(dst_query_pos, FALSE, spair);
Lookahead_set(dst_row->cell_index, 1, dst_cell);
}
Scheduler_Cell_assign(spair,
    cell, 2,
    dst_cell, 5,
    dst_score, max_score,
    transition, seed_id,
    dst_query_pos, dst_target_pos);
end_of_transition_2:
span_data = spair->span_history->span_data[0];
span_seed.score = cell->score[5][0];
if(span_seed.score >= 0){
span_seed.max = cell->score[5][1];
span_seed.seed_id = cell->score[5][2];
span_seed.cell = cell->traceback[5];
span_seed.query_entry = src_query_pos;
span_seed.target_entry = src_target_pos;
span_seed.shadow_data = &cell->score[5][3];
Scheduler_SpanData_submit(span_data,
    &span_seed, spair->span_seed_cache, spair);
}span_data = spair->span_history->span_data[0];
span_seed.score = cell->score[5][0];
if(span_seed.score >= 0){
span_seed.max = cell->score[5][1];
span_seed.seed_id = cell->score[5][2];
span_seed.cell = cell->traceback[5];
span_seed.query_entry = src_query_pos;
span_seed.target_entry = src_target_pos;
span_seed.shadow_data = &cell->score[5][3];
Scheduler_SpanData_submit(span_data,
    &span_seed, spair->span_seed_cache, spair);
}return;
}

/* ---< END >--- */

